{% extends 'base.html' %}
{% block title %}Gerenciar Horários{% endblock %}
{% block content %}

<div class="row justify-content-center">
  <div class="col-md-10">
    <div class="logo-title">Gerenciar Horários</div>

    <!-- Formulário: define dia/hora e range de faixas -->
    <div class="card p-4 mb-4">
      <form method="post" action="{{ url_for('gerenciar_horarios') }}">
        <div class="row g-3">

          <div class="col-md-4">
            <label class="form-label">Dia da semana</label>
            <select name="dia_semana" class="form-select" required>
              <option value="">Selecione...</option>
              <option value="Segunda">Segunda</option>
              <option value="Terça">Terça</option>
              <option value="Quarta">Quarta</option>
              <option value="Quinta">Quinta</option>
              <option value="Sexta">Sexta</option>
              <option value="Sábado">Sábado</option>
            </select>
          </div>

          <div class="col-md-2">
            <label class="form-label">Hora</label>
            <input type="time" name="hora" class="form-control" required>
          </div>

          <div class="col-md-3">
            <label class="form-label">Faixa inicial</label>
            <select name="faixa_inicio" class="form-select">
              <option value="">Selecione...</option>
              {% for f in FAIXAS_ORDER %}
              <option value="{{ f }}">{{ f }}</option>
              {% endfor %}
            </select>
          </div>

          <div class="col-md-3">
            <label class="form-label">Faixa final</label>
            <select name="faixa_fim" class="form-select">
              <option value="">Selecione...</option>
              {% for f in FAIXAS_ORDER %}
              <option value="{{ f }}">{{ f }}</option>
              {% endfor %}
            </select>
          </div>

          <div class="col-md-4">
            <label class="form-label">Plano (opcional)</label>
            <select name="plano" class="form-select">
              <option value="">Nenhum plano (usar faixas)</option>
              <option value="Infantil">Infantil (todas as faixas)</option>
              <option value="Tigre">Tigre (todas as faixas)</option>
            </select>
            <small class="text-muted">
              Se escolher um plano, todas as faixas serão usadas e o range será ignorado.
            </small>
          </div>

        </div>

        <div class="mt-3 text-end">
          <button type="submit" class="btn btn-primary">Aplicar configuração</button>
        </div>
      </form>
    </div>


    <div class="card p-4">
  <h5 class="mb-3">Horários cadastrados</h5>

  <form method="get" class="row g-3 mb-3">
    <div class="col-md-3">
      <label class="form-label">Dia</label>
      <select name="filtro_dia" class="form-select">
        <option value="">Todos</option>
        {% for d in dias_disponiveis %}
        <option value="{{ d }}" {% if filtro_dia == d %}selected{% endif %}>{{ d }}</option>
        {% endfor %}
      </select>
    </div>

    <div class="col-md-3">
      <label class="form-label">Horário</label>
      <select name="filtro_hora" class="form-select">
        <option value="">Todos</option>
        {% for h in horas_disponiveis %}
        <option value="{{ h }}" {% if filtro_hora == h %}selected{% endif %}>{{ h }}</option>
        {% endfor %}
      </select>
    </div>

    <div class="col-md-3">
      <label class="form-label">Faixa</label>
      <select name="filtro_faixa" class="form-select">
        <option value="">Todas</option>
        {% for f in faixas_disponiveis %}
        <option value="{{ f }}" {% if filtro_faixa == f %}selected{% endif %}>{{ f }}</option>
        {% endfor %}
      </select>
    </div>

    <div class="col-md-3">
      <label class="form-label">Plano</label>
      <select name="filtro_plano" class="form-select">
        <option value="">Todos</option>
        <option value="Infantil" {% if filtro_plano == 'Infantil' %}selected{% endif %}>Infantil</option>
        <option value="Tigre" {% if filtro_plano == 'Tigre' %}selected{% endif %}>Tigre</option>
      </select>
    </div>

    <div class="col-12 text-end">
      <button type="submit" class="btn btn-primary">Filtrar</button>
      <a href="{{ url_for('gerenciar_horarios') }}" class="btn btn-secondary">Limpar</a>
    </div>
  </form>

  {% if horarios %}
  <table class="table table-striped align-middle">
    <thead>
      <tr>
        <th>Dia</th>
        <th>Hora</th>
        <th>Faixa</th>
      </tr>
    </thead>
    <tbody>
      {% for h in horarios %}
      <tr>
        <td>{{ h.dia_semana }}</td>
        <td>{{ h.hora }}</td>
        <td>{{ h.faixa }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <div class="alert alert-info">Nenhum horário encontrado com os filtros selecionados.</div>
  {% endif %}
</div>

    <div class="mt-3">
      <a href="{{ url_for('admin_painel') }}" class="btn btn-secondary">Voltar</a>
    </div>
  </div>
</div>

{% endblock %}
